const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-YHT8twfA.js","assets/index-DD7Hi6k5.js","assets/index-B10APtjE.css"])))=>i.map(i=>d[i]);
import{R as H,r as b,j as e,a as Ue}from"./index-DD7Hi6k5.js";import{D as le,g as Ke,s as Xe,a as Ze,b as ce,c as Ye,M as Qe,T as de,d as Ie,F as Je,e as Q,L as J,C as ee,W as te,f as ne,G as et,H as tt,B as re,h as se,i as nt,j as rt,k as st,l as it,m as at,n as ue}from"./settings-Cib-WmFz.js";import{g as Oe,c as Le,p as ot,e as lt}from"./extraction-DvKe7Jqe.js";const me=t=>Symbol.iterator in t,pe=t=>"entries"in t,he=(t,n)=>{const r=t instanceof Map?t:new Map(t.entries()),s=n instanceof Map?n:new Map(n.entries());if(r.size!==s.size)return!1;for(const[a,i]of r)if(!s.has(a)||!Object.is(i,s.get(a)))return!1;return!0},ct=(t,n)=>{const r=t[Symbol.iterator](),s=n[Symbol.iterator]();let a=r.next(),i=s.next();for(;!a.done&&!i.done;){if(!Object.is(a.value,i.value))return!1;a=r.next(),i=s.next()}return!!a.done&&!!i.done};function dt(t,n){return Object.is(t,n)?!0:typeof t!="object"||t===null||typeof n!="object"||n===null||Object.getPrototypeOf(t)!==Object.getPrototypeOf(n)?!1:me(t)&&me(n)?pe(t)&&pe(n)?he(t,n):ct(t,n):he({entries:()=>Object.entries(t)},{entries:()=>Object.entries(n)})}function ge(t){const n=H.useRef(void 0);return r=>{const s=t(r);return dt(n.current,s)?n.current:n.current=s}}const fe=t=>{let n;const r=new Set,s=(d,m)=>{const u=typeof d=="function"?d(n):d;if(!Object.is(u,n)){const h=n;n=m??(typeof u!="object"||u===null)?u:Object.assign({},n,u),r.forEach(g=>g(n,h))}},a=()=>n,o={setState:s,getState:a,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=n=t(s,a,o);return o},ut=(t=>t?fe(t):fe),mt=t=>t;function pt(t,n=mt){const r=H.useSyncExternalStore(t.subscribe,H.useCallback(()=>n(t.getState()),[t,n]),H.useCallback(()=>n(t.getInitialState()),[t,n]));return H.useDebugValue(r),r}const xe=t=>{const n=ut(t),r=s=>pt(n,s);return Object.assign(r,n),r},ht=(t=>t?xe(t):xe),w=ht((t,n)=>({document:null,isLoading:!0,error:null,currentBlockIndex:0,currentCharOffset:0,currentSentenceIndex:0,currentWordIndex:0,isPlaying:!1,currentWPM:le.baseWPM,settings:le,settingsLoaded:!1,isSettingsOpen:!1,isImportOpen:!1,isHelpOpen:!1,isCompletionOpen:!1,readingStartTime:null,setDocument:r=>{if(t({document:r,isLoading:!1,currentBlockIndex:0,currentSentenceIndex:0,currentWordIndex:0}),r){const s=r.plainText.slice(0,150).trim()+(r.plainText.length>150?"...":""),a=r.metadata.source!=="web"&&r.metadata.source!=="selection";Ye({id:r.metadata.url||`doc_${r.metadata.createdAt}`,title:r.metadata.title,source:r.metadata.source,timestamp:Date.now(),preview:s,url:r.metadata.url,cachedDocument:a?r:void 0})}},setLoading:r=>t({isLoading:r}),setError:r=>t({error:r,isLoading:!1}),setPosition:(r,s=0)=>t({currentBlockIndex:r,currentCharOffset:s,currentSentenceIndex:0,currentWordIndex:0}),togglePlay:()=>t(r=>({isPlaying:!r.isPlaying})),setPlaying:r=>t({isPlaying:r}),setWPM:r=>t({currentWPM:Math.max(50,Math.min(1e3,r))}),adjustWPM:r=>t(s=>({currentWPM:Math.max(50,Math.min(1e3,s.currentWPM+r))})),setMode:r=>{const s={...n().settings,activeMode:r};t({settings:s,currentSentenceIndex:0,currentWordIndex:0}),ce(s)},updateSettings:r=>{const s={...n().settings,...r};t({settings:s}),ce(s)},loadSettings:async()=>{try{const r=await Ze();t({settings:r,currentWPM:r.baseWPM,settingsLoaded:!0})}catch(r){console.error("Failed to load settings:",r),t({settingsLoaded:!0})}},toggleSettings:()=>t(r=>({isSettingsOpen:!r.isSettingsOpen})),setImportOpen:r=>t({isImportOpen:r}),setHelpOpen:r=>t({isHelpOpen:r}),setCompletionOpen:r=>t({isCompletionOpen:r}),startReading:()=>t({readingStartTime:Date.now()}),showCompletion:()=>t({isCompletionOpen:!0,isPlaying:!1}),saveCurrentPosition:async()=>{const{document:r,currentBlockIndex:s,currentCharOffset:a}=n();r?.metadata.url&&await Xe(r.metadata.url,{blockIndex:s,charOffset:a,timestamp:Date.now()})},restorePosition:async()=>{const{document:r}=n();if(!r?.metadata.url)return;const s=await Ke(r.metadata.url);s&&s.blockIndex<r.blocks.length&&t({currentBlockIndex:s.blockIndex,currentCharOffset:s.charOffset,currentSentenceIndex:0,currentWordIndex:0})},nextBlock:()=>{const{document:r,currentBlockIndex:s}=n();r&&s<r.blocks.length-1&&t({currentBlockIndex:s+1,currentCharOffset:0,currentSentenceIndex:0,currentWordIndex:0})},prevBlock:()=>{const{currentBlockIndex:r}=n();r>0&&t({currentBlockIndex:r-1,currentCharOffset:0,currentSentenceIndex:0,currentWordIndex:0})},setSentenceIndex:r=>t({currentSentenceIndex:r}),nextSentence:()=>{t(r=>({currentSentenceIndex:r.currentSentenceIndex+1}))},prevSentence:()=>{const{currentSentenceIndex:r}=n();r>0&&t({currentSentenceIndex:r-1})},resetSentenceIndex:()=>t({currentSentenceIndex:0}),setWordIndex:r=>t({currentWordIndex:r}),nextWord:()=>{t(r=>({currentWordIndex:r.currentWordIndex+1}))},prevWord:()=>{const{currentWordIndex:r}=n();r>0&&t({currentWordIndex:r-1})},resetWordIndex:()=>t({currentWordIndex:0})})),gt=t=>t.document,ft=t=>t.isLoading,xt=t=>t.error,bt=t=>t.settings,yt=t=>t.settingsLoaded;function be({value:t,onChange:n,onAdjust:r,min:s=50,max:a=1e3,step:i=10,className:l=""}){const[o,c]=b.useState(!1),[d,m]=b.useState(t.toString()),u=b.useRef(null);b.useEffect(()=>{o||m(t.toString())},[t,o]),b.useEffect(()=>{o&&u.current&&(u.current.focus(),u.current.select())},[o]);const h=b.useCallback(()=>{const x=parseInt(d,10);if(isNaN(x))m(t.toString());else{const k=Math.max(s,Math.min(a,x));n(k),m(k.toString())}c(!1)},[d,s,a,n,t]),g=x=>{if(x.key==="Enter")h();else if(x.key==="Escape")m(t.toString()),c(!1);else if(x.key==="ArrowUp"){x.preventDefault();const k=Math.min(a,parseInt(d,10)+i);m(k.toString())}else if(x.key==="ArrowDown"){x.preventDefault();const k=Math.max(s,parseInt(d,10)-i);m(k.toString())}};return e.jsxs("div",{className:`flex items-center gap-1 ${l}`,role:"group","aria-label":"Reading speed control",children:[e.jsx("button",{onClick:()=>r(-i),className:"w-8 h-8 flex items-center justify-center rounded opacity-60 hover:opacity-100 transition-opacity",title:`Decrease speed by ${i}`,"aria-label":`Decrease speed by ${i} words per minute`,children:"−"}),o?e.jsx("input",{ref:u,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:d,onChange:x=>m(x.target.value),onBlur:h,onKeyDown:g,className:"w-16 text-center text-sm font-mono bg-transparent border border-current/20 rounded px-1 py-0.5 focus:outline-none focus:border-current/40","aria-label":"Words per minute"}):e.jsx("button",{onClick:()=>c(!0),className:"text-sm font-mono w-16 text-center hover:bg-black/5 rounded px-1 py-0.5 transition-colors cursor-text",title:"Click to edit WPM","aria-label":`Current speed: ${t} words per minute. Click to edit`,children:t}),e.jsx("span",{className:"text-xs opacity-60","aria-hidden":"true",children:"wpm"}),e.jsx("button",{onClick:()=>r(i),className:"w-8 h-8 flex items-center justify-center rounded opacity-60 hover:opacity-100 transition-opacity",title:`Increase speed by ${i}`,"aria-label":`Increase speed by ${i} words per minute`,children:"+"})]})}const kt=new Set(["mr","mrs","ms","dr","prof","sr","jr","rev","hon","gov","pres","gen","col","lt","sgt","ph","phd","md","dds","esq","llb","ma","ba","bs","mba","rn","cpa","vs","etc","eg","ie","al","approx","dept","est","inc","corp","ltd","co","jan","feb","mar","apr","jun","jul","aug","sep","sept","oct","nov","dec","mon","tue","wed","thu","fri","sat","sun","st","ave","blvd","rd","dr","ln","ct","apt","ste","fl","mt","ft","no","vol","pp","pg","ch","sec","fig","ref","ed","rev","oz","lb","lbs","ft","in","cm","mm","km","mi","kg","mg","ml","hr","min","u","uk","usa","eu"]),vt=new Set(["mr","mrs","ms","dr","prof","sr","jr","rev","hon","gov","pres","gen","col","lt","sgt","st"]);function Te(t){const n=t.replace(/\.+$/,"").toLowerCase();return!!(kt.has(n)||/^[a-zA-Z]$/.test(n)||/^[A-Z]{1,2}$/.test(t.replace(/\.$/,""))||/^[a-zA-Z]\.([a-zA-Z]\.)+$/.test(t))}function wt(t){return vt.has(t.toLowerCase().replace(/\.$/,""))}const j={SENTENCE_END:2,QUESTION:1.8,EXCLAMATION:2,ELLIPSIS:2.5,COMMA:1.5,DASH:1.3,COLON:1.6,SEMICOLON:1.7,CLOSE_PAREN:1.2,CLOSE_QUOTE:1.3,TRANSITION:1.2,PARAGRAPH_END:3,NONE:1},jt=new Set(["however","nevertheless","nonetheless","although","though","whereas","conversely","instead","rather","yet","still","furthermore","moreover","additionally","besides","also","likewise","therefore","thus","hence","consequently","accordingly","because","specifically","namely","notably","particularly","firstly","secondly","thirdly","finally","lastly","meanwhile","subsequently","ultimately","overall","essentially","basically"]);function ye(t){const n=t.replace(/[,;:]/g,"").toLowerCase();return jt.has(n)}function We(t){const n=t.trim();if(/\.{2,}$/.test(n)||/…$/.test(n))return{multiplier:j.ELLIPSIS,isEndOfSentence:!0};if(/[.!?]["'»]?$/.test(n)){if(n.endsWith(".")||/\.['"»]$/.test(n)){const r=n.replace(/["'»]+$/,"");if(Te(r))return{multiplier:j.NONE,isEndOfSentence:!1}}return/[?]["'»]?$/.test(n)?{multiplier:j.QUESTION,isEndOfSentence:!0}:/[!]["'»]?$/.test(n)?{multiplier:j.EXCLAMATION,isEndOfSentence:!0}:{multiplier:j.SENTENCE_END,isEndOfSentence:!0}}if(/[)\]]$/.test(n))return{multiplier:j.CLOSE_PAREN,isEndOfSentence:!1};if(/["'»]$/.test(n)&&!/^["'«]/.test(n))return{multiplier:j.CLOSE_QUOTE,isEndOfSentence:!1};if(/;$/.test(n))return{multiplier:j.SEMICOLON,isEndOfSentence:!1};if(/:$/.test(n))return{multiplier:j.COLON,isEndOfSentence:!1};if(/,$/.test(n)){const r=n.replace(/,$/,"");return ye(r)?{multiplier:j.COMMA+.2,isEndOfSentence:!1}:{multiplier:j.COMMA,isEndOfSentence:!1}}return/[-–—]$/.test(n)?{multiplier:j.DASH,isEndOfSentence:!1}:ye(n)?{multiplier:j.TRANSITION,isEndOfSentence:!1}:{multiplier:j.NONE,isEndOfSentence:!1}}function Nt(t){return/[!]/.test(t)?j.EXCLAMATION:/[?]/.test(t)?j.QUESTION:/\.{2,}/.test(t)||/…/.test(t)?j.ELLIPSIS:j.SENTENCE_END}const Re={en:/[aeiouy]+/gi,no:/[aeiouyæøå]+/gi},St=["ei","øy","au","ai","oi","ui","øi","æi"],Ct={en:{queue:1,area:3,idea:3,real:2,being:2,seeing:2,doing:2,going:2,saying:2,rhythm:2,synth:1,myth:1,gym:1,lynx:1,hymn:1,crypt:1,prism:2,chasm:2,ion:2,lion:2,cafe:2,fiance:3,fiancee:3,naive:2,cliche:2,recipe:3,simile:3,adobe:3,coyote:3,karate:3,the:1,they:1,eye:1,aye:1,aisle:1,isle:1,every:2,different:3,interesting:4,comfortable:4,vegetable:4,chocolate:3,business:2,family:3,beautiful:3,favorite:3,evening:2,several:3,actually:4,usually:4,probably:3,definitely:4,especially:5,basically:4,temperature:4,literature:4,environment:4,experience:4},no:{jeg:1,deg:1,seg:1,meg:1,nei:1,sei:1,hei:1,øye:2,øyne:2,øyene:3,seier:2,feier:2,leia:2,meia:2,veien:2,tiden:2,siden:2,livet:2,riket:2,hvordan:2,hvorfor:2,hvem:1,hva:1,hvor:1,hvit:1,kanskje:2,altså:2,derfor:2,fordi:2,eller:2,etter:2,under:2,over:2,mellom:2,gjennom:2,omkring:3,være:2,kunne:2,ville:2,skulle:2,måtte:2,burde:2,andre:2,første:2,mange:2,noen:2,ingen:2,alle:2,hver:1,bare:2,også:2,både:2,enda:2,hele:2,selv:1,egentlig:3,vanligvis:4,naturlig:3,tydelig:3,mulig:2,umulig:3,opplevelse:4,forståelse:4,betydelse:4,følelse:3}};let Mt={en:{},no:{}};function Pt(t,n){const r=t.toLowerCase(),s=Ct[n];if(s&&s[r]!==void 0)return s[r];const a=Mt[n];if(a&&a[r]!==void 0)return a[r]}function Et(t){const n=t.replace(/[^a-zA-Z]/g,"").toLowerCase();if(n.length<=2)return 1;const r=n.match(Re.en);let s=r?r.length:1;const a=n.endsWith("le")&&n.length>2&&!/[aeiouy]/.test(n[n.length-3]);if(n.endsWith("e")&&s>1&&!a&&s--,n.endsWith("ed")&&n.length>3){const i=n.slice(-3,-2);i!=="t"&&i!=="d"&&s--}if(n.endsWith("es")&&n.length>3){const i=n.slice(0,-2);!(i.endsWith("s")||i.endsWith("z")||i.endsWith("x")||i.endsWith("ch")||i.endsWith("sh")||i.endsWith("ce")||i.endsWith("ge"))&&s>1&&s--}return Math.max(1,s)}function It(t){const n=t.replace(/[^a-zA-ZæøåÆØÅ]/g,"").toLowerCase();if(n.length<=2)return 1;let r=n;for(const i of St)r=r.replace(new RegExp(i,"gi"),"a");const s=r.match(Re.no),a=s?s.length:1;return Math.max(1,a)}function ie(t){const n=t.toLowerCase(),r=(n.match(/[æøå]/g)||[]).length;if(r>0&&r/t.length>.001)return"no";const s=["og","jeg","det","er","en","på","som","med","har","til","av","for","ikke","den","var","om","så","han","hun","vi","fra","eller","etter","også","nå","når","kan","vil","skal","må","her","dit","bare","mange","noen","alle","andre"],a=["the","and","is","it","to","of","in","that","for","was","on","are","with","as","be","at","this","have","from","or","by","but","not","what","all","were","we","when","your","can","there","use","an","each","which","she","do","how","their","if"],i=n.split(/\s+/);let l=0,o=0;for(const c of i){const d=c.replace(/[^a-zA-ZæøåÆØÅ]/g,"");s.includes(d)&&l++,a.includes(d)&&o++}return l>o*1.5&&l>3?"no":"en"}function X(t,n="auto",r){let s="en";n==="auto"?s=ie(t):s=n;const a=t.replace(/[^a-zA-ZæøåÆØÅ]/g,"").toLowerCase();if(a.length===0)return 0;if(a.length<=2)return 1;const i=Pt(a,s);return i!==void 0?i:s==="no"?It(t):Et(t)}const Ot=new Set(["the","be","to","of","and","a","in","that","have","i","it","for","not","on","with","he","as","you","do","at","this","but","his","by","from","they","we","say","her","she","or","an","will","my","one","all","would","there","their","what","so","up","out","if","about","who","get","which","go","me","when","make","can","like","time","no","just","him","know","take","people","into","year","your","good","some","could","them","see","other","than","then","now","look","only","come","its","over","think","also","back","after","use","two","how","our","work","first","well","way","even","new","want","because","any","these","give","day","most","us","very","had","has","been","were","was","are","is","did","am","being","more","those","such","own","through","same","down","should","each","much","before","must","may","right","too","does","off","put","old","while","here","where","why","let","still","thing","every","went","made","find","long","little","great","man","world","life"]),Lt=new Set(["need","feel","seem","leave","call","keep","begin","start","help","show","hear","play","run","move","live","believe","hold","bring","happen","write","sit","stand","lose","pay","meet","include","continue","set","learn","change","lead","understand","watch","follow","stop","create","speak","read","allow","add","spend","grow","open","walk","win","offer","remember","love","consider","appear","buy","wait","serve","die","send","expect","build","stay","fall","cut","reach","kill","remain","suggest","raise","pass","sell","require","report","decide","pull","develop","tell","ask","try","turn","mean","become","night","hand","part","child","eye","woman","place","case","week","company","system","program","question","during","government","number","home","water","room","mother","area","money","story","fact","month","lot","study","book","job","word","business","issue","side","kind","head","house","service","friend","father","power","hour","game","line","end","member","law","car","city","community","name","president","team","minute","idea","kid","body","information","school","face","others","family","group","problem","party","point","percent","office","different","small","large","next","early","young","important","few","public","bad","same","able","free","sure","real","best","better","last","big","high","low","full","special","easy","clear","recent","certain","personal","red","hard","white","black","whole","true","possible","political","social","national","local","late","general","major","strong","human","international","economic","short","least","never","always","often","really","quite","probably","already","perhaps","actually","simply","almost","especially","together","likely","sometimes","away","again","ever","once","rather","usually","certainly","quickly","finally","nearly","clearly","particularly","although","against","among","however","without","between","enough","behind","far","yet","across","within","toward","whether","around","until","along","upon","since","ago","according","nothing","anything","everything","something","someone","anyone","everyone","nobody","country","state","history","process","result","reason","moment","level","form","order","view","sense","second","third","taken","given","known","done","gone","seen","today","morning","looking","coming","going","trying","getting","making","taking","having"]),Tt=new Set(["accept","achieve","act","affect","agree","apply","arrive","avoid","base","beat","break","carry","catch","cause","choose","claim","close","compare","concern","contain","control","cover","deal","describe","design","determine","discover","discuss","draw","drive","drop","enjoy","enter","establish","exist","explain","express","fail","fight","fill","finish","fly","force","forget","gain","gather","handle","hit","hope","identify","imagine","improve","increase","indicate","influence","inform","introduce","involve","join","jump","lack","laugh","lay","lie","listen","maintain","manage","mark","matter","measure","mention","miss","notice","obtain","occur","operate","organize","perform","pick","place","plan","prepare","present","press","prevent","produce","promise","protect","prove","provide","publish","push","realize","receive","recognize","reduce","reflect","refuse","relate","release","remove","replace","represent","respond","rest","return","reveal","rise","roll","rule","save","seek","separate","share","shoot","sign","sing","sleep","smile","solve","sort","sound","spread","step","strike","struggle","succeed","suffer","support","suppose","surprise","survive","teach","tend","test","thank","throw","touch","train","travel","treat","trust","visit","vote","wear","wish","wonder","worry","worth","account","activity","administration","adult","advice","age","agency","agreement","air","amount","analysis","animal","answer","application","approach","arm","army","art","article","artist","attack","attention","audience","author","authority","baby","bag","ball","bank","bar","basis","bed","behavior","benefit","bill","bit","blood","board","boat","box","boy","brain","brother","budget","building","campaign","cancer","capital","career","card","care","cell","center","century","chair","challenge","chance","character","charge","choice","church","citizen","class","club","coach","college","color","comment","commission","committee","computer","concept","condition","conference","congress","connection","conversation","cost","council","couple","course","court","crime","culture","cup","customer","daughter","data","death","debate","decision","degree","department","development","difference","director","discussion","disease","doctor","dog","door","dream","drug","education","effect","effort","election","employee","energy","environment","equipment","evening","event","evidence","example","executive","experience","expert","factor","fan","film","finger","fire","firm","fish","floor","focus","food","foot","fund","future","garden","gas","girl","glass","goal","god","ground","growth","gun","guy","hair","half","hall","heart","heat","hospital","hotel","image","impact","individual","industry","interest","investment","item","judge","justice","kitchen","knowledge","language","leader","learning","leg","letter","list","loss","machine","magazine","management","manager","market","marriage","material","media","medical","meeting","memory","message","method","middle","military","mind","model","movie","music","nation","nature","network","news","newspaper","note","object","official","oil","operation","opportunity","option","organization","owner","page","pain","painting","paper","parent","partner","patient","pattern","peace","performance","period","person","phone","picture","piece","plant","player","pm","police","policy","politics","population","position","practice","pressure","price","principle","production","professional","professor","project","property","protection","quality","race","radio","range","rate","reality","record","region","relationship","religion","research","resource","response","responsibility","restaurant","risk","road","rock","role","sale","scene","science","scientist","season","seat","section","security","series","sex","ship","shot","single","sister","site","situation","size","skill","skin","soldier","son","song","source","south","space","speech","spirit","sport","staff","stage","standard","star","statement","station","status","stock","strategy","street","structure","success","summer","surface","table","talk","task","tax","teacher","technology","television","term","text","theory","thought","threat","title","top","total","town","trade","training","treatment","trial","trip","trouble","truth","type","unit","university","value","variety","version","victim","video","violence","voice","wall","war","weight","west","wife","wind","window","winter","worker","writer","writing","yard","available","average","aware","basic","beautiful","central","civil","cold","commercial","common","complete","concerned","cultural","current","dark","dead","deep","democratic","difficult","direct","effective","entire","environmental","essential","european","excellent","existing","fair","familiar","famous","federal","final","financial","fine","foreign","former","forward","global","green","happy","healthy","heavy","helpful","historical","hot","huge","independent","industrial","interested","involved","key","legal","living","main","male","mental","modern","natural","necessary","negative","nice","normal","obvious","ok","okay","original","overall","particular","past","perfect","physical","poor","popular","positive","potential","powerful","pretty","previous","primary","private","proper","proud","quick","quiet","ready","regional","regular","related","religious","responsible","rich","safe","scientific","senior","serious","sexual","significant","similar","simple","slight","slow","specific","strange","successful","sudden","traditional","typical","unique","unlikely","various","visual","warm","western","wide","wild","willing","wrong","absolutely","alone","anyway","apparently","approximately","badly","basically","carefully","closely","completely","directly","easily","effectively","either","entirely","eventually","exactly","extremely","fairly","generally","greatly","hardly","highly","immediately","indeed","initially","instead","largely","mainly","merely","naturally","necessarily","normally","obviously","occasionally","originally","otherwise","partly","perfectly","personally","possibly","potentially","primarily","properly","recently","relatively","seriously","significantly","similarly","slightly","slowly","specifically","strongly","successfully","suddenly","therefore","thus","totally","truly","ultimately","unfortunately","widely"]),Wt=new Set(["abandon","absence","absolute","abstract","abuse","academic","accelerate","accessible","accommodate","accompany","accomplish","accurate","accuse","acknowledge","acquire","adapt","adequate","adjust","administrative","adopt","advocate","aesthetic","agenda","aggressive","allocate","alter","alternative","amid","analyze","ancestor","ancient","announce","annual","anticipate","anxiety","apparent","appeal","appreciate","appropriate","approve","architect","arise","arrange","arrest","artificial","aspect","assault","assemble","assert","assess","asset","assign","assist","assume","assumption","assure","atmosphere","attach","attain","attempt","attribute","authentic","automatic","automobile","awareness","awful","bacteria","balance","barely","barrier","battlefield","behalf","behavioral","beloved","beneath","benchmark","beneficial","beside","besides","bet","bias","billion","bind","biological","bishop","blame","blend","bless","blind","block","bold","bond","boom","boost","border","boring","borrow","boss","bother","boundary","branch","brand","brave","breach","breakdown","breakthrough","breath","breed","brick","bridge","brief","brilliant","broad","broadcast","broken","brown","brush","bulk","bullet","bunch","burden","bureau","burn","burst","bury","busy","butter","cabin","cable","calculate","calm","camera","campus","capable","capacity","capture","carbon","careful","cargo","carpet","cast","casual","catalog","category","cattle","cave","cease","celebrate","celebrity","chain","chamber","champion","channel","chaos","chapter","characteristic","charm","chart","chase","cheap","cheat","chemical","chest","chicken","chief","childhood","chip","chronic","cigarette","circle","circuit","circumstance","cite","civilian","civilization","clarify","classic","classification","classroom","clause","clay","clean","clerk","clever","click","client","cliff","climate","climb","clinic","clock","cloth","clothes","clothing","cloud","cluster","coalition","coast","code","cognitive","coin","coincide","collapse","colleague","collective","colonial","colony","column","combat","combination","combine","comfort","comfortable","command","commander","commence","commissioner","commit","commitment","commodity","communicate","communication","compact","companion","comparable","comparative","comparison","compel","compensate","compensation","compete","competition","competitive","competitor","complain","complaint","complement","complex","complexity","compliance","complicate","component","compose","composition","compound","comprehensive","comprise","compromise","compute","conceive","concentrate","concentration","conception","conclude","conclusion","concrete","conduct","confession","confidence","confident","confine","confirm","conflict","confront","confusion","congressional","conjunction","connect","conscience","conscious","consciousness","consensus","consent","consequence","conservative","considerable","consideration","consist","consistent","constant","constitute","constitution","constitutional","constraint","construct","construction","consult","consultant","consume","consumer","consumption","contact","contemporary","content","contest","context","continent","contract","contradiction","contrary","contrast","contribute","contribution","controversy","convenient","convention","conventional","conversion","convert","convey","conviction","convince","cooperate","cooperation","coordinate","cope","core","corn","corner","corporate","corporation","correct","correlation","correspond","correspondent","corridor","corrupt","corruption","costly","cottage","cotton","counter","counterpart","county","courage","cousin","coverage","crack","craft","crash","crawl","crazy","cream","creative","creature","credibility","credit","crew","criminal","crisis","criteria","criterion","critic","critical","criticism","criticize","crop","cross","crowd","crucial","crude","cruel","cry","crystal","cultivate","curiosity","curious","currency","curriculum","curtain","curve","custom","cycle","daily","dairy","damage","dance","danger","dangerous","dare","database","dawn","deadly","dealer","dean","dear","decent","declaration","declare","decline","decorate","decrease","dedicate","deem","defeat","defend","defendant","defense","defensive","deficit","define","definition","delay","delegate","deliberate","delicate","deliver","delivery","demand","democracy","demonstrate","demonstration","denial","dense","deny","depart","dependent","depict","deploy","deposit","depress","depression","depth","deputy","derive","descend","desert","deserve","designate","designer","desire","desk","desperate","destination","destroy","destruction","detail","detect","detection","detective","determination","device","devote","dialogue","diamond","diary","dictate","diet","differ","differently","dig","digital","dignity","dilemma","dimension","diminish","dining","diplomat","diplomatic","disability","disagree","disappear","disaster","discipline","disclose","discourse","discrimination","disorder","display","disposal","dispose","dispute","disrupt","dissolve","distance","distant","distinct","distinction","distinguish","distort","distribute","distribution","district","disturb","diverse","diversity","divide","division","divorce","doctrine","document","documentary","dollar","domain","domestic","dominant","dominate","donate","donor","dose","double","doubt","downtown","dozen","draft","drag","drain","drama","dramatic","dramatically","drawer","drawing","dread","drift","drill","drink","drought","drown","drunk","dry","dual","duck","due","dumb","dump","dust","duty","dwell","dynamic","eager","earn","earnings","earthquake","ease","east","eastern","echo","ecological","ecology","edge","edit","edition","editor","editorial","educate","educator","efficiency","efficient","egg","elaborate","elderly","elect","electrical","electricity","electron","electronic","element","elementary","elephant","elevate","elite","elsewhere","email","embed","embody","embrace","emerge","emergence","emergency","emission","emotion","emotional","emperor","emphasis","emphasize","empire","employ","employer","employment","empty","enable","enact","encounter","encourage","endless","endorse","endure","enemy","enforce","enforcement","engage","engagement","engine","engineer","engineering","enhance","enormous","enquiry","ensure","enterprise","entertainment","enthusiasm","enthusiastic","entity","entrance","entrepreneur","entry","envelope","episode","equal","equality","equally","equation","equip","equivalent","era","error","escape","essay","essence","estate","estimate","eternal","ethical","ethics","ethnic","evaluate","evaluation","everyday","evil","evolution","evolve","exact","exam","examination","examine","exceed","exception","excess","excessive","exchange","excitement","exclude","exclusive","excuse","execute","execution","exempt","exhibit","exhibition","exile","expansion","expectation","expense","expensive","experiment","experimental","expertise","expire","explanation","explicit","explode","exploit","exploration","explore","explorer","explosion","export","expose","exposure","extend","extension","extensive","extent","external","extra","extract","extraordinary","extreme","fabric","facilitate","facility","fade","failure","fairy","faith","faithful","fake","fame","fancy","fantasy","fare","farm","farmer","farming","fascinating","fashion","fast","fat","fatal","fate","fault","favor","favorable","favorite","fear","feast","feat","feather","feature","fee","feedback","fellow","female","fence","festival","fever","fiber","fiction","fierce","fifteen"]),Rt=new Set(["og","i","er","det","som","en","på","å","av","for","med","har","til","de","den","ikke","om","et","var","jeg","men","så","vi","han","du","kan","skal","seg","fra","eller","etter","ved","også","være","vil","hun","alle","sin","når","her","nå","bare","meg","mot","dette","dem","ham","opp","ut","inn","over","selv","mange","andre","blir","før","meget","få","dag","ble","disse","kunne","har","ville","hva","hele","siden","under","går","år","kom","hadde","hvor","hvis","slik","enn","helt","jo","ned","blitt","både","gang","tid","noen","få","gjøre","ta","sa","gi","se","del","oss","der","første","være","måtte","måte","stor","gå","kom","nye","godt","land","samme","skulle","mann","aldri","egen","god","ingen","litt","sier","stor","større","må","henne","stort","siste","to","tre","ting","altså","jo","ja","nei","hver","hvem","hvordan","hvorfor","heller"]),Dt=new Set(["komme","gjøre","finne","stå","ta","sette","ligge","bruke","vite","tro","tenke","si","lese","skrive","arbeide","leve","holde","kalle","føle","mene","synes","høre","snakke","fortelle","spørre","svare","vise","begynne","slutte","fortsette","prøve","legge","sitte","løpe","gå","flytte","kjøre","reise","handle","kjøpe","selge","betale","koste","hjelpe","støtte","bygge","lage","skape","utvikle","endre","øke","redusere","åpne","lukke","starte","stoppe","vente","møte","forstå","huske","glemme","lære","undervise","studere","jobbe","spille","vinne","tape","delta","bestemme","menneske","barn","kvinne","folk","liv","verden","sted","hus","hjem","familie","venn","mor","far","bror","søster","datter","sønn","navn","ord","språk","bok","side","bilde","film","musikk","kunst","historie","spørsmål","svar","problem","løsning","arbeid","jobb","penger","pris","verdi","grunn","årsak","resultat","effekt","mål","plan","idé","tanke","mening","følelse","håp","frykt","kjærlighet","hat","vann","mat","drikke","kropp","hode","hånd","øye","ansikt","hjerte","blod","by","gate","vei","kirke","skole","sykehus","butikk","marked","samfunn","stat","regjering","parti","valg","lov","rett","frihet","makt","krig","fred","sikkerhet","god","ny","gammel","ung","stor","liten","lang","kort","høy","lav","bred","smal","tykk","tynn","hard","myk","varm","kald","våt","tørr","rik","fattig","sterk","svak","rask","langsom","lett","vanskelig","enkel","kompleks","viktig","nødvendig","mulig","umulig","sikker","usikker","klar","uklar","ren","skitten","vakker","stygg","glad","trist","sint","rolig","stille","høyt","lavt","full","tom","åpen","lukket","fri","opptatt","ferdig","klar","redd","modig","snill","ikke","også","bare","kanskje","sikkert","virkelig","egentlig","faktisk","dessverre","heldigvis","alltid","aldri","ofte","sjelden","noen","gang","iblant","vanligvis","plutselig","gradvis","raskt","sakte","tidlig","sent","snart","straks","allerede","ennå","fortsatt","igjen","sammen","alene","borte","hjemme","ute","inne","oppe","nede","fremme","tilbake"]),_t=new Set(["akseptere","analysere","anta","anvende","avslutte","avvise","behandle","beholde","bekrefte","bekymre","beregne","beskrive","beskytte","besøke","bety","bevege","bidra","danne","dele","demonstrere","diskutere","dominere","drepe","drive","dømme","eksistere","eksportere","eliminere","endre","engasjere","erstatte","etablere","evaluere","fastslå","feile","feire","finansiere","fokusere","forbedre","forby","fordele","foreslå","forestille","forhandle","forklare","forlate","forme","formulere","fornye","forske","forsøke","forstyrre","forsvare","forsvinne","fortjene","forvirre","fremme","garantere","godkjenne","gripe","håndtere","identifisere","ignorere","illustrere","importere","informere","inkludere","inneholde","innføre","innse","inspirere","installere","interessere","investere","invitere","kjempe","knytte","kombinere","kommunisere","konkludere","konkurrere","konsultere","kontakte","kontrollere","konvertere","kopiere","korrigere","koste","kreve","kritisere","administrasjon","aktør","aktivitet","alternativ","analyse","ansvar","argument","aspekt","atmosfære","autoritet","avdeling","avis","avtale","bakgrunn","balanse","bank","basis","befolkning","begrep","behov","bevis","betydning","bevegelse","bibliotek","bidrag","borger","bransje","budsjett","bygning","data","debatt","definisjon","demokrati","detalj","dialog","dimensjon","dokument","domstol","drøm","dynamikk","egenskap","eier","eksempel","ekspert","element","energi","enhet","erfaring","erklæring","etikk","faktor","fase","fenomen","figur","filosofi","fokus","fordel","foreldre","forening","forfatter","forhandling","forhold","forklaring","form","formål","forskning","forslag","forståelse","fortsettelse","frihet","funksjon","fylke","gevinst","grad","grense","gruppe","gutt","handling","hendelse","hensikt","absolutt","akseptabel","aktuell","allmenn","alternativ","ansvarlig","betydelig","daglig","demokratisk","direkte","effektiv","eksakt","ekstra","elektrisk","endelig","eneste","enorm","europeisk","eventuell","fantastisk","farlig","felles","finansiell","foreløpig","formell","fornuftig","forsiktig","forskjellig","framtidig","generell","geografisk","gjeldende","global","grundig","gyldig","helhetlig","historisk","hovedsakelig","hyppig","ideell","imponerende","indirekte","individuell","industriell","interessant","intern","internasjonal","juridisk","klassisk","klinisk","kollektiv","kommersiell","komplett","konkret","konstant","konstruktiv","kontinuerlig","kreativ","kritisk","kulturell","kunstig","kvalifisert","lokal","logisk","lovlig","maksimal","materiell","meningsfull","merkbar","metodisk","militær","minimal","moderne","moralsk","nasjonal","naturlig","negativ","nervøs","nøyaktig","nøytral"]),Bt=new Set(["abstrakt","akademisk","akselerere","akutt","algoritme","allegorisk","ambisiøs","analytisk","anerkjenne","anonymisere","antagonist","antropologi","anvendelig","aristokrati","arkitektonisk","arrogant","artikulere","assimilere","asymmetrisk","autentisk","autoritær","avansert","bakterie","banal","begrense","bekreftelse","beredskapsmessig","berettiget","besettelse","bibliografi","bilateral","biografi","biologisk","bioteknologi","bisarr","bærekraftig","byråkrati","cerebral","karakteristisk","karismatisk","kategorisere","kjemisk","klassifisere","klimatisk","koherent","kollidere","kolonial","kompatibel","kompensere","komplisert","komponere","kompromittere","konfidensielt","konfrontere","konservativ","konsolidere","konstitusjonell","kontekst","kontrast","kontrovers","konvensjonell","koordinere","korporativ","korrelasjon","korrespondere","kosmopolitisk","kriminell","kronologisk","kuriositet","kvalitativ","kvantitativ","kybernetikk","legitimere","liberal","lingvistisk","litterær","logistikk","lukrativ","makroøkonomisk","manifestere","manipulere","marginalisere","meditasjon","mellommenneskelig","mentalitet","metabolisme","metafor","metamorfose","metodologi","mikroskopisk","minimalistisk","mobilisere","modifisere","molekylær","monopol","monoton","monumental","multikulturell","muskulær","mystisk","navigere","nettverksbygging","nevrologisk","nominere","normalisere","nostalgi","notorisk","numerisk","objektiv","obligatorisk","observere","offensiv","oligarki","ominøs","omnipotent","operasjonell","opportunistisk","optimalisere","orkestrere","ortodoks","oscillere","paradigme","paradoks","parallell","parameter","paranoid","patologi","patriarkalsk","pedagogisk","perifer","permanent","personifisere","perspektiv","pessimistisk","phenomenon","pionér","pittoresk","plagiering","polemisk","politisere","populisme","potensiell","pragmatisk","predikere","predominant","preferanse","prejudisert","prematur","prestisjefylt","prevalens"]),At={en:{tier1:Ot,tier2:Lt,tier3:Tt,tier4:Wt},no:{tier1:Rt,tier2:Dt,tier3:_t,tier4:Bt}},$t={1:.7,2:.85,3:1,4:1.15,5:1.3},Ft={en:["ing","ed","es","s","er","est","ly","ment","ness","tion","sion","able","ible","ful","less","ous","ive","al","ial"],no:["ing","ene","ene","er","et","en","a","te","de","ende","else","het","lig","isk","som","bar","løs","full","aktig","messig"]},zt={en:/[^a-z]/g,no:/[^a-zæøå]/g};function Ht(t,n){const r=[t],s=Ft[n];for(const a of s)if(t.endsWith(a)&&t.length>a.length+2){const i=t.slice(0,-a.length);r.push(i),i.length>1&&i[i.length-1]===i[i.length-2]&&r.push(i.slice(0,-1)),r.push(i+"e"),i.endsWith("i")&&r.push(i.slice(0,-1)+"y")}return r}function Gt(t,n="en"){const r=n==="auto"?ie(t):n,s=At[r],a=zt[r],i=t.toLowerCase().replace(a,"");if(!i||i.length===0)return 3;if(s.tier1.has(i))return 1;if(s.tier2.has(i))return 2;if(s.tier3.has(i))return 3;if(s.tier4.has(i))return 4;const l=Ht(i,r);for(const c of l){if(s.tier1.has(c))return 1;if(s.tier2.has(c))return 2;if(s.tier3.has(c))return 3;if(s.tier4.has(c))return 4}const o=i.length;return o<=3?2:o>=10?5:(o>=8,4)}function qt(t,n="en"){const r=Gt(t,n);return $t[r]}function Vt(t,n=1){const r=[],s=t.split(/\n\n+/);for(let a=0;a<s.length;a++){const i=s[a].trim();if(!i)continue;const l=i.split(/\s+/).filter(o=>o.length>0);for(let o=0;o<l.length;o+=n){const c=l.slice(o,o+n).join(" "),d=l[Math.min(o+n-1,l.length-1)],{multiplier:m,isEndOfSentence:u}=We(d),g=o+n>=l.length&&a<s.length-1,x=g?Math.max(m,j.PARAGRAPH_END):m;r.push({text:c,pauseMultiplier:x,isEndOfSentence:u,isEndOfParagraph:g})}}return r}function Ut(t,n,r){const s=6e4/n,a=t.text.split(/\s+/).length;let i=s*a;return r&&(i*=t.pauseMultiplier),i}function De(t){const n=t.replace(/[^\w]/g,"");return n.length<=1?0:n.length<=5?1:Math.floor(n.length*.3)}function B(t){return t.split(/\s+/).filter(n=>n.length>0).length}function ae(t){const n=[],r=/[^.!?]*[.!?]+["'»]?\s*/g;let s,a=0;for(;(s=r.exec(t))!==null;){const i=s[0].trim();i.length>0&&(n.push({text:i,wordCount:B(i),startIndex:s.index,endIndex:s.index+s[0].length,pauseMultiplier:Nt(i)}),a=s.index+s[0].length)}if(a<t.length){const i=t.slice(a).trim();i.length>0&&n.push({text:i,wordCount:B(i),startIndex:a,endIndex:t.length,pauseMultiplier:j.NONE})}return n.length===0&&t.trim().length>0&&n.push({text:t.trim(),wordCount:B(t),startIndex:0,endIndex:t.length,pauseMultiplier:j.NONE}),n}function oe(t){const n=[],r=/\S+/g;let s;for(;(s=r.exec(t))!==null;){const a=s[0],{multiplier:i,isEndOfSentence:l}=We(a);n.push({text:a,startIndex:s.index,endIndex:s.index+a.length,pauseMultiplier:i,isEndOfSentence:l})}return n}function Kt(t,n,r){let a=6e4/n*t.wordCount;return r&&(a*=t.pauseMultiplier),Math.max(300,a)}function Xt(t,n="en"){const s=t.replace(/[^a-zA-ZæøåÆØÅ]/g,"").length,a=X(t,n);if(s<=2)return 0;if(s<=3)return .1;const i=Math.min(1,(s-3)/9),l=Math.min(1,(a-1)/3);return i*.4+l*.6}function Zt(t,n,r,s=!1,a="en"){let l=6e4/n;if(s){const o=Xt(t.text,a),c=qt(t.text,a),m=(.7+o*.6)*.4+c*.6;l*=m}return r&&(l*=t.pauseMultiplier),Math.max(80,l)}function ke(t){if(t<1)return`${Math.round(t*60)}s`;if(t<60)return`${Math.round(t)}m`;const n=Math.floor(t/60),r=Math.round(t%60);return r>0?`${n}h ${r}m`:`${n}h`}function ve({totalText:t,currentBlockIndex:n,blocks:r,wpm:s,className:a=""}){const{remaining:i,total:l}=b.useMemo(()=>{const o=B(t);let c=0;for(let h=0;h<n&&h<r.length;h++){const g=r[h],x=g.content||g.items?.join(" ")||"";c+=B(x)}const m=Math.max(0,o-c)/s,u=o/s;return{remaining:ke(m),total:ke(u)}},[t,n,r,s]);return e.jsxs("span",{className:`text-xs opacity-60 ${a}`,title:`Total: ${l}`,children:[i," left"]})}function Yt({onImportClick:t}){const{document:n,isPlaying:r,currentWPM:s,currentBlockIndex:a,settings:i,togglePlay:l,setWPM:o,adjustWPM:c,setMode:d,toggleSettings:m}=w(),u=()=>{window.close()},h=i.activeMode==="bionic";return e.jsx("header",{className:"fixed top-0 left-0 right-0 z-40 px-2 pt-2 md:px-4 md:pt-3",role:"banner",children:e.jsxs("div",{className:"mx-auto rounded-xl px-2 py-2 shadow-lg md:max-w-4xl md:px-4",style:{backgroundColor:i.backgroundColor,border:"1px solid rgba(128, 128, 128, 0.2)"},children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 md:gap-4",children:[e.jsx("div",{className:"hidden md:block flex-1 min-w-0",children:e.jsx("h1",{className:"text-sm font-medium truncate opacity-80",children:n?.metadata.title||"FlowReader"})}),e.jsx("div",{className:"flex items-center gap-1 bg-black/5 rounded-lg p-0.5",role:"tablist","aria-label":"Reading mode",children:Qe.map(g=>e.jsx("button",{onClick:()=>d(g.value),role:"tab","aria-selected":i.activeMode===g.value,className:`px-2 py-1.5 text-xs font-medium rounded-md transition-all min-w-[44px] md:px-3 md:py-1 ${i.activeMode===g.value?"bg-white shadow-sm":"opacity-60 hover:opacity-100"}`,children:g.label},g.value))}),e.jsxs("div",{className:"hidden md:flex items-center gap-3",style:{visibility:h?"hidden":"visible"},children:[e.jsx(be,{value:s,onChange:o,onAdjust:c}),i.showTimeRemaining&&n&&e.jsx(ve,{totalText:n.plainText,currentBlockIndex:a,blocks:n.blocks,wpm:s})]}),e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",role:"toolbar","aria-label":"Reader controls",children:[e.jsx("button",{onClick:l,className:"w-10 h-10 flex items-center justify-center rounded-lg bg-black/5 hover:bg-black/10 md:w-8 md:h-8",title:r?"Pause (Space)":"Play (Space)","aria-label":r?"Pause reading":"Start reading","aria-pressed":r,children:r?e.jsxs("svg",{className:"w-5 h-5 md:w-4 md:h-4",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),e.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}):e.jsx("svg",{className:"w-5 h-5 md:w-4 md:h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("polygon",{points:"5,3 19,12 5,21"})})}),e.jsx("button",{onClick:t,className:"flex w-10 h-10 items-center justify-center rounded opacity-60 hover:opacity-100 md:w-8 md:h-8",title:"Import file","aria-label":"Import document",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),e.jsx("button",{onClick:m,className:"w-10 h-10 flex items-center justify-center rounded opacity-60 hover:opacity-100 md:w-8 md:h-8",title:"Settings","aria-label":"Open settings",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("button",{onClick:u,className:"w-10 h-10 flex items-center justify-center rounded opacity-60 hover:opacity-100 md:w-8 md:h-8",title:"Exit Reader","aria-label":"Close reader",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]})]}),!h&&e.jsxs("div",{className:"flex md:hidden items-center justify-center gap-3 mt-2 pt-2 border-t border-current/10",children:[e.jsx(be,{value:s,onChange:o,onAdjust:c}),i.showTimeRemaining&&n&&e.jsx(ve,{totalText:n.plainText,currentBlockIndex:a,blocks:n.blocks,wpm:s})]})]})})}function Qt(t){const n=[],r=t.split(/([.!?]+["'»]?\s*)/);let s="";for(let a=0;a<r.length;a++){const i=r[a];if(i)if(/^[.!?]+["'»]?\s*$/.test(i)){const l=s.trim().split(/\s+/),o=l[l.length-1],c=r[a+1],d=o&&Te(o+".");let m=!0;d&&(/^[A-Z]\.?$/.test(o)||wt(o)||c&&/^[a-z]/.test(c.trim())?m=!1:(!c||c.trim(),m=!0)),m?(s+=i,s.trim()&&n.push(s.trim()),s=""):s+=i}else s+=i}return s.trim()&&n.push(s.trim()),n.filter(a=>a.length>0)}function Jt(t,n="en"){return t.filter(r=>{const s=r.replace(/[^a-zA-ZæøåÆØÅ]/g,"").toLowerCase();if(s.length<3)return!1;if(X(s,n)>=3){const i=s.replace(/ed$/,"").replace(/es$/,"").replace(/ing$/,"");return!(X(i,n)<3)}return!1}).length}function en(t,n="auto"){const r=t.split(/\s+/).filter(p=>p.length>0),s=Qt(t),a=n==="auto"?ie(t):n;if(r.length===0||s.length===0)return{fleschReadingEase:100,fleschKincaidGrade:0,gunningFogIndex:0,smogIndex:0,avgWordsPerSentence:0,avgSyllablesPerWord:0,complexWordPercentage:0,difficultyLevel:"easy",wpmMultiplier:1,detectedLanguage:a};const i=r.length,l=s.length,o=r.reduce((p,N)=>p+X(N,a),0),c=Jt(r,a),d=i/l,m=o/i,u=c/i*100,h=Math.max(0,Math.min(100,206.835-1.015*d-84.6*m)),g=Math.max(0,.39*d+11.8*m-15.59),x=Math.max(0,.4*(d+u)),k=l>=3?Math.max(0,1.043*Math.sqrt(c*(30/l))+3.1291):g;let v,f;const y=g*.4+x*.3+k*.3;return y<=6?(v="easy",f=1.15):y<=10?(v="medium",f=1):y<=14?(v="hard",f=.9):(v="very-hard",f=.8),{fleschReadingEase:Math.round(h*10)/10,fleschKincaidGrade:Math.round(g*10)/10,gunningFogIndex:Math.round(x*10)/10,smogIndex:Math.round(k*10)/10,avgWordsPerSentence:Math.round(d*10)/10,avgSyllablesPerWord:Math.round(m*100)/100,complexWordPercentage:Math.round(u*10)/10,difficultyLevel:v,wpmMultiplier:f,detectedLanguage:a}}function _e({isPlaying:t,wpm:n,targetWPM:r,rampEnabled:s,rampStep:a,rampInterval:i,onAdjustWPM:l}){const o=b.useRef(null);b.useEffect(()=>{if(o.current&&(clearInterval(o.current),o.current=null),!t||!s||n>=r)return;const c=i*1e3;return o.current=window.setInterval(()=>{const d=Math.min(a,r-n);d>0?l(d):o.current&&(clearInterval(o.current),o.current=null)},c),()=>{o.current&&(clearInterval(o.current),o.current=null)}},[t,s,a,i,r,n,l])}function tn(t){return B(Oe(t))}function nn({blocks:t,currentBlockIndex:n,wpm:r,isPlaying:s,settings:a,onNextBlock:i,currentSentenceIndex:l,currentWordIndex:o,onNextSentence:c,onNextWord:d,onResetSentenceIndex:m,onResetWordIndex:u,onAdjustWPM:h,onComplete:g}){const x=b.useRef(null),{pacingGranularity:k,pacingPauseOnPunctuation:v,pacingAdaptiveSpeed:f,pacingReadabilitySpeed:y}=a,{rampEnabled:p,rampStep:N,rampInterval:M,targetWPM:W}=a;_e({isPlaying:s,wpm:r,targetWPM:W,rampEnabled:p,rampStep:N,rampInterval:M,onAdjustWPM:h});const S=t[n],P=S?Oe(S):"",R=b.useMemo(()=>{if(!y||!P)return r;const _=en(P);return Math.round(r*_.wpmMultiplier)},[r,P,y]),D=b.useMemo(()=>k!=="sentence"?[]:ae(P),[P,k]),I=b.useMemo(()=>k!=="word"?[]:oe(P),[P,k]),G=D[l],O=I[o],L=n>=t.length-1,V=b.useMemo(()=>{switch(k){case"sentence":return l>=D.length-1;case"word":return o>=I.length-1;default:return!0}},[k,l,D.length,o,I.length]),U=b.useCallback(()=>{switch(k){case"word":o<I.length-1?d():L||(u(),i());break;case"sentence":l<D.length-1?c():L||(m(),i());break;default:L||i();break}},[k,o,I.length,l,D.length,L,d,c,i,u,m]),K=b.useCallback(()=>{switch(k){case"word":return O?Zt(O,R,v,f):6e4/R;case"sentence":return G?Kt(G,R,v):1e3;default:const Z=(S?tn(S):1)/R*60*1e3;return Math.max(500,Z)}},[k,O,G,S,R,v,f]);return b.useEffect(()=>{if(x.current&&(clearTimeout(x.current),x.current=null),!s||t.length===0||!S)return;if(L&&V){s&&g?.();return}const _=K();return x.current=window.setTimeout(U,_),()=>{x.current&&(clearTimeout(x.current),x.current=null)}},[s,t.length,S,L,V,K,U,n,l,o]),null}function rn({text:t,wpm:n,isPlaying:r}){const{settings:s,adjustWPM:a,showCompletion:i}=w(),[l,o]=b.useState(0),[c,d]=b.useState(!0),m=b.useRef(null),u=Vt(t,s.rsvpChunkSize),h=B(t),g=u[l];_e({isPlaying:r,wpm:n,targetWPM:s.targetWPM,rampEnabled:s.rampEnabled,rampStep:s.rampStep,rampInterval:s.rampInterval,onAdjustWPM:a});const x=b.useCallback(()=>{o(p=>p>=u.length-1?(i(),p):p+1)},[u.length,i]);b.useEffect(()=>{if(!r||!g){m.current&&clearTimeout(m.current);return}const p=Ut(g,n,s.rsvpPauseOnPunctuation);return m.current=window.setTimeout(x,p),()=>{m.current&&clearTimeout(m.current)}},[r,l,g,n,s.rsvpPauseOnPunctuation,x]),b.useEffect(()=>{const p=N=>{switch(N.key){case"ArrowRight":case"j":N.preventDefault(),x();break;case"ArrowLeft":case"k":N.preventDefault(),o(M=>Math.max(0,M-1));break}};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[x]);const k=()=>d(!1);if(!g)return e.jsx("div",{className:"rsvp-container",children:e.jsx("p",{className:"opacity-60",children:"No content to display"})});const v=p=>{const N=De(p),M=p.slice(0,N),W=p[N]||"",S=p.slice(N+1);return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:M}),e.jsx("span",{className:"rsvp-orp",children:W}),e.jsx("span",{children:S})]})},f=(l+1)/u.length*100,y=Math.round(l/u.length*h);return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center pt-16 pb-8 px-4",children:[c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50"}),e.jsx("div",{className:"fixed inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-md rounded-xl shadow-2xl z-50 overflow-hidden",style:{backgroundColor:"var(--reader-bg)",color:"var(--reader-text)",border:"1px solid rgba(128, 128, 128, 0.3)"},children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"RSVP Mode"}),e.jsx("p",{className:"text-sm opacity-80 mb-4",children:"Rapid Serial Visual Presentation shows one word at a time at high speed. While this can help train reading speed, research suggests it may reduce comprehension for long-form reading. Use this mode for training exercises rather than important content."}),e.jsx("button",{onClick:k,className:"w-full py-2 rounded-lg font-medium transition-colors",style:{backgroundColor:"var(--reader-link)",color:"#ffffff"},children:"I understand, continue"})]})})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-4 w-0.5 h-3 bg-current opacity-30"}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-4 w-0.5 h-3 bg-current opacity-30"}),e.jsx("div",{className:"rsvp-word font-reader min-w-[200px]",children:v(g.text)})]})})}),e.jsxs("div",{className:"w-full max-w-md space-y-4",children:[e.jsx("div",{className:"h-1 bg-current/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-current/40 transition-all duration-100",style:{width:`${f}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm opacity-60",children:[e.jsxs("span",{children:[y," / ",h," words"]}),e.jsxs("span",{children:[n," WPM"]})]}),e.jsx("input",{type:"range",min:"0",max:u.length-1,value:l,onChange:p=>o(Number(p.target.value)),className:"w-full"})]})]})}function sn(t,n){if(!t||t.length===0)return{bold:"",regular:""};let r=t.length<=3?Math.max(1,Math.floor(t.length*n)):Math.max(1,Math.round(t.length*n));return r=Math.min(r,t.length),{bold:t.slice(0,r),regular:t.slice(r)}}function an(t,n=.4){return(t.match(/[\w]+|[^\w]+/g)||[]).map(s=>/\w/.test(s)?sn(s,n):{bold:"",regular:s})}function on(t){return Math.round(600+t*200)}function Be({text:t,intensity:n,proportion:r}){const s=an(t,r),a=on(n);return e.jsx(e.Fragment,{children:s.map((i,l)=>e.jsxs("span",{children:[i.bold&&e.jsx("span",{className:"bionic-bold",style:{fontWeight:a},children:i.bold}),i.regular]},l))})}function Ae({text:t,granularity:n,currentIndex:r,indexOffset:s=0,pacingSettings:a,onItemClick:i}){const{pacingHighlightStyle:l,pacingDimContext:o,pacingShowGuide:c,pacingBoldFocusLetter:d}=a,m=b.useMemo(()=>n!=="word"?[]:oe(t),[n,t]),u=b.useMemo(()=>n!=="sentence"?[]:ae(t),[n,t]);return n==="word"&&m.length>0?e.jsx("span",{className:"pacing-text",children:m.map((h,g)=>{const x=s+g,k=x===r,v=x<r;let f="pacing-word cursor-pointer";k?(f+=` pacing-word-active pacing-style-${l}`,c&&(f+=" pacing-word-guide")):v&&o?f+=" pacing-word-past":!v&&o&&(f+=" pacing-word-future");const y=g<m.length-1?" ":"",p=De(h.text),N=M=>{M.stopPropagation(),i(x)};if(k&&(c||d)){const M=h.text.slice(0,p),W=h.text[p]||"",S=h.text.slice(p+1),P=h.text.length>0?(p+.5)/h.text.length*100:50;return e.jsxs("span",{className:f,style:{"--orp-position":`${P}%`},onClick:N,children:[M,e.jsx("span",{className:`pacing-orp-letter ${d?"pacing-orp-bold":""}`,children:W}),S,y]},g)}return e.jsxs("span",{className:f,onClick:N,children:[h.text,y]},g)})}):n==="sentence"&&u.length>0?e.jsx("span",{className:"pacing-text",children:u.map((h,g)=>{const x=s+g,k=x===r,v=x<r;let f="pacing-sentence cursor-pointer";k?f+=` pacing-sentence-active pacing-style-${l}`:v&&o?f+=" pacing-sentence-past":!v&&o&&(f+=" pacing-sentence-future");const y=p=>{p.stopPropagation(),i(x)};return e.jsxs("span",{className:f,onClick:y,children:[h.text," "]},g)})}):e.jsx(e.Fragment,{children:t})}function ln({item:t,itemIndex:n,isBlockActive:r,mode:s,bionicConfig:a,pacingConfig:i,position:l,allItems:o,onWordClick:c,onSentenceClick:d}){const m=b.useMemo(()=>{let h=0;for(let g=0;g<n;g++)h+=oe(o[g]).length;return h},[n,o]),u=b.useMemo(()=>{if(i.granularity!=="sentence")return 0;let h=0;for(let g=0;g<n;g++)h+=ae(o[g]).length;return h},[n,o,i.granularity]);return s.isBionic?e.jsx("li",{children:e.jsx(Be,{text:t,intensity:a.intensity,proportion:a.proportion})}):s.isPacing&&i.granularity!=="block"?e.jsx("li",{children:e.jsx(Ae,{text:t,granularity:i.granularity,currentIndex:r?i.granularity==="word"?l.wordIndex:l.sentenceIndex:-1,indexOffset:i.granularity==="word"?m:u,pacingSettings:i,onItemClick:i.granularity==="word"?c:d})}):e.jsx("li",{children:t})}function cn({block:t,index:n,isActive:r,mode:s,bionicConfig:a,pacingConfig:i,position:l,handlers:o}){const c=()=>!s.isPacing||!i.pacingDimContext||r?"":"opacity-40",d=x=>s.isBionic?e.jsx(Be,{text:x,intensity:a.intensity,proportion:a.proportion}):s.isPacing&&i.granularity!=="block"?e.jsx(Ae,{text:x,granularity:i.granularity,currentIndex:r?i.granularity==="word"?l.wordIndex:l.sentenceIndex:-1,pacingSettings:i,onItemClick:i.granularity==="word"?o.onWordClick:o.onSentenceClick}):x,m=()=>r?s.isPacing&&i.granularity==="block"?`pacing-block-active pacing-style-${i.highlightStyle} -mx-2 px-2 rounded`:s.isPacing?"":"bg-reader-highlight/20 -mx-2 px-2 rounded":"",u=c(),g=`cursor-pointer ${m()} ${u}`.trim();switch(t.type){case"heading":{const x=`h${t.level}`;return e.jsx(x,{"data-block-index":n,className:g,onClick:o.onClick,children:d(t.content)})}case"paragraph":return e.jsx("p",{"data-block-index":n,className:g,onClick:o.onClick,children:d(t.content)});case"list":{const x=t.ordered?"ol":"ul";return e.jsx(x,{"data-block-index":n,className:g,onClick:o.onClick,children:t.items.map((k,v)=>e.jsx(ln,{item:k,itemIndex:v,isBlockActive:r,mode:s,bionicConfig:a,pacingConfig:i,position:l,allItems:t.items,onWordClick:o.onWordClick,onSentenceClick:o.onSentenceClick},v))})}case"quote":return e.jsx("blockquote",{"data-block-index":n,className:g,onClick:o.onClick,children:d(t.content)});case"code":return e.jsx("pre",{"data-block-index":n,className:g,onClick:o.onClick,children:e.jsx("code",{className:t.language?`language-${t.language}`:"",children:t.content})});default:return null}}const $=["pacing","bionic","rsvp"],F=["block","sentence","word"];function we(t){const{settings:n,nextWord:r,nextSentence:s,nextBlock:a}=t;return n.activeMode!=="pacing"?a:n.pacingGranularity==="word"?r:n.pacingGranularity==="sentence"?s:a}function je(t){const{settings:n,prevWord:r,prevSentence:s,prevBlock:a}=t;return n.activeMode!=="pacing"?a:n.pacingGranularity==="word"?r:n.pacingGranularity==="sentence"?s:a}const dn={" ":(t,{togglePlay:n})=>n(),ArrowRight:(t,n)=>we(n)(),j:(t,n)=>we(n)(),ArrowLeft:(t,n)=>je(n)(),k:(t,n)=>je(n)(),ArrowUp:(t,{adjustWPM:n})=>n(t.shiftKey?50:10),ArrowDown:(t,{adjustWPM:n})=>n(t.shiftKey?-50:-10),m:(t,{settings:n,setMode:r})=>{const s=$.indexOf(n.activeMode);r($[(s+1)%$.length])},M:(t,{settings:n,setMode:r})=>{const s=$.indexOf(n.activeMode);r($[(s+1)%$.length])},b:(t,{settings:n,setMode:r})=>{r(n.activeMode==="bionic"?"pacing":"bionic")},B:(t,{settings:n,setMode:r})=>{r(n.activeMode==="bionic"?"pacing":"bionic")},g:(t,{settings:n,updateSettings:r})=>{if(n.activeMode==="pacing"){const s=F.indexOf(n.pacingGranularity);r({pacingGranularity:F[(s+1)%F.length]})}},G:(t,{settings:n,updateSettings:r})=>{if(n.activeMode==="pacing"){const s=F.indexOf(n.pacingGranularity);r({pacingGranularity:F[(s+1)%F.length]})}},Escape:(t,{overlays:n})=>{n?.isHelpOpen?n.closeHelp():n?.isImportOpen?n.closeImport():n?.isSettingsOpen?n.closeSettings():window.close()},"?":(t,{overlays:n})=>{n?.isHelpOpen?n.closeHelp():n?.openHelp()}};function un(t){const n=b.useCallback(r=>{if(r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;const s=dn[r.key];s&&(r.preventDefault(),s(r,t))},[t]);b.useEffect(()=>(window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)),[n])}const mn={minSwipeDistance:50,maxSwipeTime:300};function pn(t,n,r={}){const s={...mn,...r},a=b.useRef(null);b.useEffect(()=>{const i=t.current;if(!i)return;const l=c=>{const d=c.touches[0];a.current={x:d.clientX,y:d.clientY,time:Date.now()}},o=c=>{if(!a.current)return;const d=c.changedTouches[0],m=d.clientX-a.current.x,u=d.clientY-a.current.y,h=Date.now()-a.current.time;if(a.current=null,h>s.maxSwipeTime)return;const g=Math.abs(m),x=Math.abs(u);g>x&&g>=s.minSwipeDistance?m>0?n.onSwipeRight?.():n.onSwipeLeft?.():x>g&&x>=s.minSwipeDistance&&(u>0?n.onSwipeDown?.():n.onSwipeUp?.())};return i.addEventListener("touchstart",l,{passive:!0}),i.addEventListener("touchend",o,{passive:!0}),()=>{i.removeEventListener("touchstart",l),i.removeEventListener("touchend",o)}},[t,n,s.minSwipeDistance,s.maxSwipeTime])}function hn(){const{document:t,currentBlockIndex:n,settings:r,setPosition:s,isPlaying:a,currentWPM:i,nextBlock:l,prevBlock:o,togglePlay:c,adjustWPM:d,setMode:m,updateSettings:u,currentSentenceIndex:h,currentWordIndex:g,nextSentence:x,nextWord:k,prevSentence:v,prevWord:f,resetSentenceIndex:y,resetWordIndex:p,setWordIndex:N,setSentenceIndex:M,isSettingsOpen:W,toggleSettings:S,isImportOpen:P,setImportOpen:R,isHelpOpen:D,setHelpOpen:I,showCompletion:G}=w(),O=b.useRef(null);un({settings:r,togglePlay:c,nextBlock:l,prevBlock:o,nextWord:k,prevWord:f,nextSentence:x,prevSentence:v,adjustWPM:d,setMode:m,updateSettings:u,overlays:{isSettingsOpen:W,closeSettings:S,isImportOpen:P,closeImport:()=>R(!1),isHelpOpen:D,openHelp:()=>I(!0),closeHelp:()=>I(!1)}});const L=b.useMemo(()=>({onSwipeLeft:()=>{r.pacingGranularity==="word"?k():r.pacingGranularity==="sentence"?x():l()},onSwipeRight:()=>{r.pacingGranularity==="word"?f():r.pacingGranularity==="sentence"?v():o()},onSwipeUp:()=>d(20),onSwipeDown:()=>d(-20)}),[r.pacingGranularity,k,x,l,f,v,o,d]);if(pn(O,L),b.useEffect(()=>{if(O.current&&t){const C=O.current.querySelector(`[data-block-index="${n}"]`);C&&C.scrollIntoView({behavior:"smooth",block:"center"})}},[n,t]),!t)return null;const V=C=>s(C,0),U=(C,E)=>{C!==n&&s(C,0),N(E)},K=(C,E)=>{C!==n&&s(C,0),M(E)};if(r.activeMode==="rsvp")return e.jsx(rn,{text:t.plainText,wpm:i,isPlaying:a});const _=r.activeMode==="pacing",Z={isPacing:_,isBionic:r.activeMode==="bionic"},He={intensity:r.bionicIntensity,proportion:r.bionicProportion},Ge={granularity:r.pacingGranularity,highlightStyle:r.pacingHighlightStyle,pacingHighlightStyle:r.pacingHighlightStyle,pacingDimContext:r.pacingDimContext,pacingShowGuide:r.pacingShowGuide,pacingBoldFocusLetter:r.pacingBoldFocusLetter},qe={sentenceIndex:h,wordIndex:g};return e.jsxs("main",{ref:O,className:"reader-content pt-20 pb-16 px-4",style:{maxWidth:r.columnWidth,margin:"0 auto",textAlign:r.textAlign,hyphens:r.hyphenation?"auto":"none"},children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:t.metadata.title}),t.metadata.author&&e.jsx("p",{className:"opacity-60",children:t.metadata.author}),t.metadata.publishedAt&&e.jsx("p",{className:"text-sm opacity-50",children:t.metadata.publishedAt})]}),_&&e.jsx(nn,{blocks:t.blocks,currentBlockIndex:n,wpm:i,isPlaying:a,settings:r,onNextBlock:l,currentSentenceIndex:h,currentWordIndex:g,onNextSentence:x,onNextWord:k,onResetSentenceIndex:y,onResetWordIndex:p,onAdjustWPM:d,onComplete:G}),e.jsx("div",{className:"relative",children:t.blocks.map((C,E)=>{const Ve={onClick:()=>V(E),onWordClick:Y=>U(E,Y),onSentenceClick:Y=>K(E,Y)};return e.jsx(cn,{block:C,index:E,isActive:E===n,mode:Z,bionicConfig:He,pacingConfig:Ge,position:qe,handlers:Ve},C.id)})})]})}const $e=b.createContext(null);function Fe(){const t=b.useContext($e);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function gn({children:t}){const[n,r]=b.useState([]),s=b.useCallback(i=>{r(l=>l.filter(o=>o.id!==i))},[]),a=b.useCallback((i,l="info",o=3e3)=>{const c=`toast_${Date.now()}_${Math.random().toString(36).slice(2)}`,d={id:c,message:i,type:l,duration:o};r(m=>[...m,d]),o>0&&setTimeout(()=>s(c),o)},[s]);return e.jsxs($e.Provider,{value:{toasts:n,showToast:a,dismissToast:s},children:[t,e.jsx(fn,{toasts:n,onDismiss:s})]})}function fn({toasts:t,onDismiss:n}){return t.length===0?null:e.jsx("div",{className:"fixed bottom-4 right-4 z-[100] flex flex-col gap-2 max-w-sm",children:t.map(r=>e.jsx(xn,{toast:r,onDismiss:n},r.id))})}function xn({toast:t,onDismiss:n}){const r={success:"rgba(34, 197, 94, 0.95)",error:"rgba(239, 68, 68, 0.95)",info:"rgba(59, 130, 246, 0.95)"}[t.type],s={success:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),error:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),info:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}[t.type];return e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg text-white animate-slide-in",style:{backgroundColor:r},role:"alert",children:[s,e.jsx("p",{className:"flex-1 text-sm font-medium",children:t.message}),e.jsx("button",{onClick:()=>n(t.id),className:"opacity-70 hover:opacity-100 transition-opacity","aria-label":"Dismiss",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function bn({onApplyTheme:t}){const n=de.filter(s=>s.category==="standard"),r=de.filter(s=>s.category==="eye-friendly");return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Theme"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs opacity-50 mb-2",children:"Standard"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:n.map(s=>e.jsx(Ne,{theme:s.value,label:s.label,onClick:t},s.value))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs opacity-50 mb-2",children:"Eye-Friendly"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:r.map(s=>e.jsx(Ne,{theme:s.value,label:s.label,onClick:t},s.value))})]})]})]})}function Ne({theme:t,label:n,onClick:r}){const s=Ie[t];return e.jsx("button",{onClick:()=>r(t),className:"px-3 py-2 text-sm rounded-lg border border-current/20 hover:border-current/40 transition-colors min-h-[44px] md:py-1.5 md:min-h-0",style:{backgroundColor:s.backgroundColor,color:s.textColor},children:n})}function yn({presets:t,onSave:n,onLoad:r,onDelete:s}){const[a,i]=b.useState(""),[l,o]=b.useState(!1),{showToast:c}=Fe(),d=()=>{const u=a.trim();if(!u){c("Please enter a preset name","error");return}n(u),i(""),o(!1)},m=Object.keys(t);return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Presets"}),e.jsxs("div",{className:"space-y-3",children:[m.length>0&&e.jsx("div",{className:"space-y-2",children:m.map(u=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg border border-current/20 hover:border-current/40 transition-colors",children:[e.jsx("button",{onClick:()=>r(u),className:"flex-1 text-left text-sm truncate",title:`Load "${u}"`,children:u}),e.jsx("button",{onClick:()=>s(u),className:"w-8 h-8 flex items-center justify-center opacity-50 hover:opacity-100 hover:text-red-500 transition-colors",title:`Delete "${u}"`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},u))}),l?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:a,onChange:u=>i(u.target.value),onKeyDown:u=>u.key==="Enter"&&d(),placeholder:"Preset name...",className:"flex-1 px-3 py-2 rounded-lg border border-current/20 bg-transparent text-sm",autoFocus:!0}),e.jsx("button",{onClick:d,className:"px-3 py-2 text-sm rounded-lg border border-current/20 hover:border-current/40 hover:bg-current/5 transition-colors",children:"Save"}),e.jsx("button",{onClick:()=>{o(!1),i("")},className:"px-3 py-2 text-sm rounded-lg border border-current/20 hover:border-current/40 transition-colors opacity-60",children:"Cancel"})]}):e.jsxs("button",{onClick:()=>o(!0),className:"w-full px-3 py-2 text-sm rounded-lg border border-dashed border-current/30 hover:border-current/50 hover:bg-current/5 transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v16m8-8H4"})}),"Save current settings as preset"]}),m.length===0&&!l&&e.jsx("p",{className:"text-xs opacity-50 text-center py-2",children:"No saved presets yet"})]})]})}function A({label:t,value:n,min:r,max:s,step:a=1,unit:i="",formatValue:l,onChange:o,className:c=""}){const d=l?l(n):`${n}${i}`;return e.jsxs("div",{className:c,children:[e.jsxs("label",{className:"block text-sm mb-1 opacity-70",children:[t,": ",d]}),e.jsx("input",{type:"range",min:r,max:s,step:a,value:n,onChange:m=>o(Number(m.target.value))})]})}function T({id:t,label:n,checked:r,onChange:s,className:a=""}){return e.jsxs("div",{className:`flex items-center gap-3 min-h-[44px] md:min-h-0 ${a}`,children:[e.jsx("input",{type:"checkbox",id:t,checked:r,onChange:i=>s(i.target.checked),className:"rounded"}),e.jsx("label",{htmlFor:t,className:"text-sm flex-1",children:n})]})}function kn({label:t,value:n,options:r,onChange:s,className:a=""}){return e.jsxs("div",{className:a,children:[e.jsx("label",{className:"block text-sm mb-1 opacity-70",children:t}),e.jsx("select",{value:n,onChange:i=>s(i.target.value),className:"w-full px-3 py-3 rounded-lg border border-current/20 bg-transparent text-base md:py-2 md:text-sm",children:r.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function Se({options:t,value:n,onChange:r,className:s=""}){return e.jsx("div",{className:`flex gap-2 flex-wrap ${s}`,children:t.map(a=>e.jsx("button",{onClick:()=>r(a.value),className:`px-3 py-2 text-sm rounded-lg border transition-colors min-h-[44px] md:py-1.5 md:min-h-0 ${n===a.value?"border-current bg-current/10":"border-current/20 hover:border-current/40"}`,title:a.description,children:a.label},a.value))})}function vn({settings:t,onUpdate:n}){return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Typography"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(kn,{label:"Font",value:t.fontFamily,options:Je,onChange:r=>n({fontFamily:r})}),e.jsx(A,{label:"Font Size",value:t.fontSize,min:Q.min,max:Q.max,step:Q.step,unit:"px",onChange:r=>n({fontSize:r})}),e.jsx(A,{label:"Line Height",value:t.lineHeight,min:J.min,max:J.max,step:J.step,onChange:r=>n({lineHeight:r})}),e.jsx(A,{label:"Column Width",value:t.columnWidth,min:ee.min,max:ee.max,step:ee.step,unit:"px",onChange:r=>n({columnWidth:r})})]})]})}function wn({settings:t,onUpdate:n}){return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Speed"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{label:"Base Speed",value:t.baseWPM,min:te.min,max:te.max,step:te.step,unit:" WPM",onChange:r=>n({baseWPM:r})}),e.jsx(T,{id:"rampEnabled",label:"Enable speed ramp-up",checked:t.rampEnabled,onChange:r=>n({rampEnabled:r})}),t.rampEnabled&&e.jsxs(e.Fragment,{children:[e.jsx(A,{label:"Target Speed",value:t.targetWPM,min:ne.min,max:ne.max,step:ne.step,unit:" WPM",onChange:r=>n({targetWPM:r})}),e.jsx("div",{children:e.jsxs("label",{className:"block text-sm mb-1 opacity-70",children:["Increase by ",t.rampStep," WPM every ",t.rampInterval,"s"]})})]})]})]})}function jn({settings:t,onUpdate:n}){return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Pacing"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 opacity-70",children:"Highlight"}),e.jsx(Se,{options:et,value:t.pacingGranularity,onChange:r=>n({pacingGranularity:r})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 opacity-70",children:"Style"}),e.jsx(Se,{options:tt,value:t.pacingHighlightStyle,onChange:r=>n({pacingHighlightStyle:r})})]}),e.jsx(T,{id:"pacingDimContext",label:"Dim surrounding text",checked:t.pacingDimContext,onChange:r=>n({pacingDimContext:r})}),e.jsx(T,{id:"pacingShowGuide",label:"Show reading guide",checked:t.pacingShowGuide,onChange:r=>n({pacingShowGuide:r})}),t.pacingGranularity==="word"&&e.jsxs(e.Fragment,{children:[e.jsx(T,{id:"pacingBoldFocusLetter",label:"Bold focus letter (like Bionic)",checked:t.pacingBoldFocusLetter,onChange:r=>n({pacingBoldFocusLetter:r})}),e.jsx(T,{id:"pacingAdaptiveSpeed",label:"Adaptive speed (vary by word complexity)",checked:t.pacingAdaptiveSpeed,onChange:r=>n({pacingAdaptiveSpeed:r})})]}),e.jsx(T,{id:"pacingReadabilitySpeed",label:"Adjust speed by paragraph difficulty",checked:t.pacingReadabilitySpeed,onChange:r=>n({pacingReadabilitySpeed:r})}),e.jsx(T,{id:"pacingPauseOnPunctuation",label:"Pause on punctuation",checked:t.pacingPauseOnPunctuation,onChange:r=>n({pacingPauseOnPunctuation:r})})]})]})}function Nn({settings:t,onUpdate:n}){return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Bionic Reading"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{label:"Intensity",value:t.bionicIntensity,min:re.min,max:re.max,step:re.step,formatValue:r=>`${Math.round(r*100)}%`,onChange:r=>n({bionicIntensity:r})}),e.jsx(A,{label:"Bold Proportion",value:t.bionicProportion,min:se.min,max:se.max,step:se.step,formatValue:r=>`${Math.round(r*100)}%`,onChange:r=>n({bionicProportion:r})})]})]})}function Sn({settings:t,onUpdate:n}){return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Display"}),e.jsx("div",{className:"space-y-4",children:e.jsx(T,{id:"showTimeRemaining",label:"Show time remaining",checked:t.showTimeRemaining,onChange:r=>n({showTimeRemaining:r})})})]})}function Cn(){return e.jsxs("div",{className:"settings-group",children:[e.jsx("h3",{children:"Keyboard Shortcuts"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[e.jsx("span",{className:"opacity-70",children:"Play / Pause"}),e.jsx("kbd",{className:"text-right opacity-60",children:"Space"}),e.jsx("span",{className:"opacity-70",children:"Next"}),e.jsx("kbd",{className:"text-right opacity-60",children:"→ or J"}),e.jsx("span",{className:"opacity-70",children:"Previous"}),e.jsx("kbd",{className:"text-right opacity-60",children:"← or K"}),e.jsx("span",{className:"opacity-70",children:"Speed up"}),e.jsx("kbd",{className:"text-right opacity-60",children:"↑"}),e.jsx("span",{className:"opacity-70",children:"Speed down"}),e.jsx("kbd",{className:"text-right opacity-60",children:"↓"}),e.jsx("span",{className:"opacity-70",children:"Cycle mode"}),e.jsx("kbd",{className:"text-right opacity-60",children:"M"}),e.jsx("span",{className:"opacity-70",children:"Toggle Bionic"}),e.jsx("kbd",{className:"text-right opacity-60",children:"B"}),e.jsx("span",{className:"opacity-70",children:"Cycle granularity"}),e.jsx("kbd",{className:"text-right opacity-60",children:"G"}),e.jsx("span",{className:"opacity-70",children:"Close"}),e.jsx("kbd",{className:"text-right opacity-60",children:"Esc"})]}),e.jsx("button",{onClick:()=>chrome.tabs.create({url:"chrome://extensions/shortcuts"}),className:"mt-3 text-xs opacity-60 hover:opacity-100 underline",children:"Customize extension shortcuts"})]})]})}function Mn(){const{isSettingsOpen:t,settings:n,updateSettings:r,toggleSettings:s}=w(),{showToast:a}=Fe(),[i,l]=b.useState({});b.useEffect(()=>{t&&nt().then(l)},[t]);const o=u=>{const h=Ie[u];r({backgroundColor:h.backgroundColor,textColor:h.textColor,linkColor:h.linkColor,selectionColor:h.selectionColor,highlightColor:h.highlightColor})},c=async u=>{await rt(u,{...n}),l(h=>({...h,[u]:{...n}})),a(`Preset "${u}" saved`,"success")},d=u=>{const h=i[u];h&&(r(h),a(`Preset "${u}" applied`,"success"))},m=async u=>{await st(u),l(h=>{const{[u]:g,...x}=h;return x}),a(`Preset "${u}" deleted`,"info")};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black/20 z-90",onClick:s,"aria-hidden":"true"}),e.jsxs("aside",{className:`settings-panel ${t?"open":""}`,role:"dialog","aria-label":"Settings","aria-modal":"true","aria-hidden":!t,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",id:"settings-title",children:"Settings"}),e.jsx("button",{onClick:s,className:"w-10 h-10 flex items-center justify-center rounded opacity-60 hover:opacity-100 md:w-8 md:h-8","aria-label":"Close settings",children:e.jsx("svg",{className:"w-6 h-6 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(bn,{onApplyTheme:o}),e.jsx(yn,{presets:i,onSave:c,onLoad:d,onDelete:m}),e.jsx(vn,{settings:n,onUpdate:r}),n.activeMode!=="bionic"&&e.jsx(wn,{settings:n,onUpdate:r}),n.activeMode==="pacing"&&e.jsx(jn,{settings:n,onUpdate:r}),n.activeMode==="bionic"&&e.jsx(Nn,{settings:n,onUpdate:r}),e.jsx(Sn,{settings:n,onUpdate:r}),e.jsx(Cn,{})]})]})}function Pn(){const{document:t,currentBlockIndex:n}=w();if(!t||t.blocks.length===0)return null;const r=(n+1)/t.blocks.length*100;return e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-bar-fill",style:{width:`${r}%`}})})}const En="modulepreload",In=function(t){return"/"+t},Ce={},ze=function(n,r,s){let a=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=l?.nonce||l?.getAttribute("nonce");a=c(r.map(d=>{if(d=In(d),d in Ce)return;Ce[d]=!0;const m=d.endsWith(".css"),u=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const h=document.createElement("link");if(h.rel=m?"stylesheet":En,m||(h.as="script"),h.crossOrigin="",h.href=d,o&&h.setAttribute("nonce",o),document.head.appendChild(h),m)return new Promise((g,x)=>{h.addEventListener("load",g),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return n().catch(i)})};class z extends Error{constructor(n,r,s){super(n),this.type=r,this.originalError=s,this.name="PdfExtractionError"}}async function Me(t){let n;try{n=await ze(()=>import("./pdf-CdE6nnZT.js"),[])}catch(c){throw new z("Failed to load PDF processing library.","unknown",c)}n.GlobalWorkerOptions.workerSrc=chrome.runtime.getURL("pdf.worker.min.mjs");let r;try{const c=await t.arrayBuffer();r=await n.getDocument({data:c}).promise}catch(c){const d=c instanceof Error?c.message:String(c);throw d.includes("password")?new z("This PDF is password-protected. Please provide an unprotected version.","password-protected",c):d.includes("Invalid PDF")||d.includes("corrupted")?new z("This PDF appears to be corrupted or invalid.","corrupted",c):new z("Failed to open PDF file: "+d,"unknown",c)}if(r.numPages===0)throw new z("This PDF has no pages.","empty");const s=[],a=[];for(let c=1;c<=r.numPages;c++){const m=await(await r.getPage(c)).getTextContent();let u="";for(const h of m.items){const g=h;u+=g.str,g.hasEOL&&(u+=`
`)}s.push(u)}const l=s.join(`

`).split(/\n\n+/);for(const c of l){const d=c.trim();d.length>0&&a.push(d)}if(a.length===0)throw new z("No text could be extracted from this PDF. This may be a scanned document without a text layer. OCR support is not available in this version.","no-text-layer");const o=a.map((c,d)=>({type:"paragraph",content:c,id:`block-${d}`}));return Le(o,{title:t.name.replace(/\.pdf$/i,""),source:"pdf"})}async function On(){const t=await ze(()=>import("./index-YHT8twfA.js").then(n=>n.i),__vite__mapDeps([0,1,2]));return t.default||t}async function Pe(t){const n=await On(),r=await t.arrayBuffer(),s=await n.convertToHtml({arrayBuffer:r}),a=ot(s.value,{handleTables:!0});return Le(a,{title:t.name.replace(/\.docx?$/i,""),source:"docx"})}function Ee({isOpen:t,onClose:n}){const{setDocument:r}=w(),[s,a]=b.useState(""),[i,l]=b.useState(!1),[o,c]=b.useState(null),[d,m]=b.useState([]),u=b.useRef(null);b.useEffect(()=>{t&&it().then(m)},[t]);const h=async f=>{const y=f.target.files?.[0];if(y){l(!0),c(null);try{let p;if(y.name.endsWith(".pdf"))p=await Me(y);else if(y.name.endsWith(".docx"))p=await Pe(y);else throw new Error("Unsupported file type. Please use PDF or DOCX files.");r(p),n()}catch(p){c(p instanceof Error?p.message:"Failed to import file")}finally{l(!1),u.current&&(u.current.value="")}}},g=f=>{f.preventDefault(),f.stopPropagation()},x=async f=>{f.preventDefault(),f.stopPropagation();const y=f.dataTransfer.files?.[0];if(y){if(!y.name.endsWith(".pdf")&&!y.name.endsWith(".docx")){c("Unsupported file type. Please use PDF or DOCX files.");return}l(!0),c(null);try{let p;y.name.endsWith(".pdf")?p=await Me(y):p=await Pe(y),r(p),n()}catch(p){c(p instanceof Error?p.message:"Failed to import file")}finally{l(!1)}}},k=async f=>{if(c(null),f.cachedDocument){r(f.cachedDocument),n();return}if(f.url&&f.source==="web"){l(!0);try{const y=await chrome.runtime.sendMessage({type:"EXTRACT_FROM_URL",url:f.url});y?.error?c(`Failed to reload: ${y.error}. Try visiting the original page.`):y?(r(y),n()):c("Failed to reload content. Try visiting the original page.")}catch{c("Failed to reload content. Try visiting the original page.")}finally{l(!1)}return}c("This document cannot be reopened. Please import it again.")},v=()=>{if(!s.trim())return;const f=lt(s);r(f),a(""),n()};return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:n,"aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-lg rounded-xl shadow-2xl z-50 overflow-hidden",style:{backgroundColor:"var(--reader-bg)",color:"var(--reader-text)",border:"1px solid rgba(128, 128, 128, 0.3)"},role:"dialog","aria-modal":"true","aria-labelledby":"import-dialog-title",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{id:"import-dialog-title",className:"text-xl font-semibold",children:"Import Content"}),e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full opacity-60 hover:opacity-100 transition-opacity","aria-label":"Close import dialog",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o&&e.jsx("div",{className:"mb-4 p-3 rounded-lg text-sm",style:{backgroundColor:"rgba(220, 38, 38, 0.1)",color:"var(--reader-text)",border:"1px solid rgba(220, 38, 38, 0.3)"},role:"alert",children:o}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium mb-2 opacity-80",id:"upload-label",children:"Upload File"}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",style:{borderColor:"rgba(128, 128, 128, 0.4)"},onMouseEnter:f=>f.currentTarget.style.borderColor="var(--reader-link)",onMouseLeave:f=>f.currentTarget.style.borderColor="rgba(128, 128, 128, 0.4)",onClick:()=>u.current?.click(),onDragOver:g,onDrop:x,role:"button",tabIndex:0,"aria-labelledby":"upload-label",onKeyDown:f=>f.key==="Enter"&&u.current?.click(),children:[e.jsx("input",{ref:u,type:"file",accept:".pdf,.docx",onChange:h,className:"hidden","aria-label":"Select file to upload"}),i?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"var(--reader-link)"}}),e.jsx("span",{children:"Importing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-10 h-10 mx-auto mb-2 opacity-40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"font-medium",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-sm opacity-60 mt-1",children:"PDF or DOCX files"})]})]}),e.jsx("p",{className:"text-xs opacity-50 mt-2",children:"Note: Scanned PDFs without a text layer cannot be imported. OCR is not supported."})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 h-px",style:{backgroundColor:"rgba(128, 128, 128, 0.3)"}}),e.jsx("span",{className:"text-sm opacity-50",children:"or"}),e.jsx("div",{className:"flex-1 h-px",style:{backgroundColor:"rgba(128, 128, 128, 0.3)"}})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2 opacity-80",id:"paste-label",children:"Paste Text"}),e.jsx("textarea",{value:s,onChange:f=>a(f.target.value),placeholder:"Paste your text here...",className:"w-full h-32 p-3 rounded-lg resize-none focus:outline-none focus:ring-2 transition-colors",style:{backgroundColor:"var(--reader-bg)",color:"var(--reader-text)",border:"1px solid rgba(128, 128, 128, 0.3)"},onFocus:f=>f.currentTarget.style.boxShadow="0 0 0 2px var(--reader-link)",onBlur:f=>f.currentTarget.style.boxShadow="none","aria-labelledby":"paste-label"}),e.jsx("button",{onClick:v,disabled:!s.trim(),className:"mt-2 w-full py-2 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--reader-link)",color:"#ffffff"},children:"Start Reading"})]}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 my-6",children:[e.jsx("div",{className:"flex-1 h-px",style:{backgroundColor:"rgba(128, 128, 128, 0.3)"}}),e.jsx("span",{className:"text-sm opacity-50",children:"Recent"}),e.jsx("div",{className:"flex-1 h-px",style:{backgroundColor:"rgba(128, 128, 128, 0.3)"}})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:d.slice(0,5).map(f=>e.jsx("button",{onClick:()=>k(f),className:"w-full text-left p-3 rounded-lg transition-colors",style:{backgroundColor:"rgba(128, 128, 128, 0.1)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="rgba(128, 128, 128, 0.2)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="rgba(128, 128, 128, 0.1)",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded flex items-center justify-center opacity-60",style:{backgroundColor:"rgba(128, 128, 128, 0.2)"},children:f.source==="web"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9"})}):f.source==="pdf"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:f.title}),e.jsx("p",{className:"text-xs opacity-50 truncate",children:f.preview}),e.jsx("p",{className:"text-xs opacity-40 mt-1",children:new Date(f.timestamp).toLocaleDateString()})]})]})},f.id))})]})]})})]}):null}const Ln=[{keys:["Space"],description:"Play / Pause"},{keys:["→","J"],description:"Next word/sentence/block"},{keys:["←","K"],description:"Previous word/sentence/block"},{keys:["↑"],description:"Increase speed (+10 WPM)"},{keys:["↓"],description:"Decrease speed (-10 WPM)"},{keys:["Shift","↑"],description:"Increase speed (+50 WPM)"},{keys:["Shift","↓"],description:"Decrease speed (-50 WPM)"},{keys:["M"],description:"Cycle reading mode"},{keys:["B"],description:"Toggle Bionic mode"},{keys:["G"],description:"Cycle granularity (Pacing mode)"},{keys:["?"],description:"Show this help"},{keys:["Esc"],description:"Close reader / overlay"}];function Tn({isOpen:t,onClose:n}){return b.useEffect(()=>{if(!t)return;const r=s=>{(s.key==="Escape"||s.key==="?")&&(s.preventDefault(),n())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[t,n]),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[200] backdrop-blur-sm",onClick:n}),e.jsx("div",{className:"fixed inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-md rounded-xl shadow-2xl z-[201] overflow-hidden fade-in",style:{backgroundColor:"var(--reader-bg)",color:"var(--reader-text)",border:"1px solid rgba(128, 128, 128, 0.3)"},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Keyboard Shortcuts"}),e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full opacity-60 hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:Ln.map((r,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm opacity-80",children:r.description}),e.jsx("div",{className:"flex items-center gap-1",children:r.keys.map((a,i)=>e.jsxs("span",{children:[e.jsx("kbd",{className:"inline-flex items-center justify-center min-w-[28px] h-7 px-2 rounded text-xs font-mono",style:{backgroundColor:"rgba(128, 128, 128, 0.15)",border:"1px solid rgba(128, 128, 128, 0.3)",boxShadow:"0 1px 0 rgba(128, 128, 128, 0.3)"},children:a}),i<r.keys.length-1&&e.jsx("span",{className:"text-xs opacity-40 mx-1",children:"or"})]},i))})]},s))}),e.jsx("div",{className:"mt-6 pt-4 border-t border-current/10 text-center",children:e.jsxs("p",{className:"text-xs opacity-50",children:["Press ",e.jsx("kbd",{className:"px-1.5 py-0.5 rounded text-xs",style:{backgroundColor:"rgba(128, 128, 128, 0.15)"},children:"?"})," or ",e.jsx("kbd",{className:"px-1.5 py-0.5 rounded text-xs",style:{backgroundColor:"rgba(128, 128, 128, 0.15)"},children:"Esc"})," to close"]})})]})})]}):null}function Wn({isOpen:t,onClose:n,onReadAgain:r,onImportNew:s}){const{document:a,readingStartTime:i,currentWPM:l}=w();if(!t||!a)return null;const o=i?Date.now()-i:0,c=Math.floor(o/6e4),d=Math.floor(o%6e4/1e3),m=a.plainText.split(/\s+/).length;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[200] backdrop-blur-sm",onClick:n,"aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-md rounded-xl shadow-2xl z-[201] overflow-hidden fade-in",style:{backgroundColor:"var(--reader-bg)",color:"var(--reader-text)",border:"1px solid rgba(128, 128, 128, 0.3)"},role:"dialog","aria-modal":"true","aria-labelledby":"completion-title",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"rgba(34, 197, 94, 0.15)"},"aria-hidden":"true",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"rgb(34, 197, 94)",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{id:"completion-title",className:"text-2xl font-bold mb-2",children:"Reading Complete!"}),e.jsxs("p",{className:"opacity-60 mb-6",children:[`You've finished "`,a.metadata.title,'"']}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8 py-4 border-y border-current/10",role:"group","aria-label":"Reading statistics",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold","aria-label":`${m.toLocaleString()} words`,children:m.toLocaleString()}),e.jsx("p",{className:"text-xs opacity-50 uppercase tracking-wide","aria-hidden":"true",children:"Words"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold","aria-label":`${c} minutes ${d} seconds`,children:c>0?`${c}m ${d}s`:`${d}s`}),e.jsx("p",{className:"text-xs opacity-50 uppercase tracking-wide","aria-hidden":"true",children:"Time"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold","aria-label":`${l} words per minute`,children:l}),e.jsx("p",{className:"text-xs opacity-50 uppercase tracking-wide","aria-hidden":"true",children:"WPM"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:r,className:"w-full py-3 rounded-lg font-medium transition-colors",style:{backgroundColor:"var(--reader-link)",color:"#ffffff"},children:"Read Again"}),e.jsx("button",{onClick:s,className:"w-full py-3 rounded-lg font-medium transition-colors",style:{backgroundColor:"rgba(128, 128, 128, 0.15)"},children:"Import New Content"}),e.jsx("button",{onClick:n,className:"w-full py-2 text-sm opacity-60 hover:opacity-100 transition-opacity",children:"Close"})]})]})})]})}const q=[{title:"Welcome to FlowReader",description:"A speed reading tool that helps you read faster and retain more. Let's get you started with a quick tour.",icon:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})},{title:"Three Reading Modes",description:"Pacing highlights text as you read. RSVP shows one word at a time. Bionic bolds word beginnings for faster scanning. Press M to cycle between modes.",icon:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 6h16M4 12h16M4 18h7"})})},{title:"Control Your Speed",description:"Use the arrow keys to adjust your reading speed. Enable speed ramp-up in settings to gradually increase your pace as you get comfortable.",icon:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 10V3L4 14h7v7l9-11h-7z"})})},{title:"Import Content",description:"Click the Import button to load articles from URLs, paste text, or upload PDF/DOCX files. Your reading position is saved automatically.",icon:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})},{title:"Keyboard Shortcuts",description:"Space to play/pause, arrows to navigate, G to change granularity, B for bionic mode. Press ? anytime to see all shortcuts.",icon:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}];function Rn({onComplete:t}){const[n,r]=b.useState(0),s=()=>{n<q.length-1?r(n+1):i()},a=()=>{n>0&&r(n-1)},i=async()=>{await ue(),t()},l=async()=>{await ue(),t()},o=q[n],c=n===q.length-1;return e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",style:{maxHeight:"90vh"},children:[e.jsx("div",{className:"h-1 bg-gray-200",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${(n+1)/q.length*100}%`}})}),e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"mb-6 flex justify-center text-blue-500",children:o.icon}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:o.title}),e.jsx("p",{className:"text-gray-600 leading-relaxed mb-8",children:o.description}),e.jsx("div",{className:"flex justify-center gap-2 mb-8",children:q.map((d,m)=>e.jsx("button",{onClick:()=>r(m),className:`w-2.5 h-2.5 rounded-full transition-colors ${m===n?"bg-blue-500":m<n?"bg-blue-300":"bg-gray-300"}`,"aria-label":`Go to step ${m+1}`},m))}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[n>0&&e.jsx("button",{onClick:a,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"Back"}),e.jsx("button",{onClick:s,className:"px-6 py-2.5 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors font-medium",children:c?"Get Started":"Next"})]}),!c&&e.jsx("button",{onClick:l,className:"mt-4 text-sm text-gray-400 hover:text-gray-600 transition-colors",children:"Skip tutorial"})]})]})})}function Dn(){const[t,n]=b.useState(!1),[r,s]=b.useState(!1);return b.useEffect(()=>{at().then(i=>{n(!i),s(!0)})},[]),{showOnboarding:t,close:()=>n(!1),checked:r}}function _n(){const t=w(gt),n=w(ft),r=w(xt),s=w(bt),a=w(yt),{isPlaying:i}=w(ge(p=>({isPlaying:p.isPlaying}))),{isImportOpen:l,isHelpOpen:o,isCompletionOpen:c}=w(ge(p=>({isImportOpen:p.isImportOpen,isHelpOpen:p.isHelpOpen,isCompletionOpen:p.isCompletionOpen}))),d=w(p=>p.setDocument),m=w(p=>p.setError),u=w(p=>p.setImportOpen),h=w(p=>p.setHelpOpen),g=w(p=>p.setCompletionOpen),x=w(p=>p.loadSettings),k=w(p=>p.setPosition),v=w(p=>p.restorePosition),f=w(p=>p.saveCurrentPosition),y=Dn();return b.useEffect(()=>{x()},[x]),b.useEffect(()=>{async function p(){try{const N=await chrome.runtime.sendMessage({type:"GET_PENDING_DOCUMENT"});N?d(N):u(!0)}catch{m("Failed to load document. Please try again.")}}p()},[d,m]),b.useEffect(()=>{t&&a&&v()},[t,a,v]),b.useEffect(()=>{!i&&t&&f()},[i,t,f]),b.useEffect(()=>{const p=()=>{t&&f()};return window.addEventListener("beforeunload",p),()=>window.removeEventListener("beforeunload",p)},[t,f]),b.useEffect(()=>{const p=window.document.documentElement;p.style.setProperty("--reader-bg",s.backgroundColor),p.style.setProperty("--reader-text",s.textColor),p.style.setProperty("--reader-link",s.linkColor),p.style.setProperty("--reader-selection",s.selectionColor),p.style.setProperty("--font-reader",s.fontFamily),p.style.setProperty("--font-size",`${s.fontSize}px`),p.style.setProperty("--line-height",String(s.lineHeight)),p.style.setProperty("--paragraph-spacing",`${s.paragraphSpacing}px`),window.document.body.style.backgroundColor=s.backgroundColor,window.document.body.style.color=s.textColor},[s]),n||!a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-current mx-auto mb-4"}),e.jsx("p",{className:"opacity-60",children:"Loading..."})]})}):r?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center max-w-md px-4",children:[e.jsx("h1",{className:"text-xl font-semibold mb-2",children:"FlowReader"}),e.jsx("p",{className:"opacity-70 mb-4",children:r}),e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Import Content"}),e.jsx(Ee,{isOpen:l,onClose:()=>u(!1)})]})}):e.jsxs("div",{className:"min-h-screen fade-in",children:[e.jsx(Pn,{}),e.jsx(Yt,{onImportClick:()=>u(!0)}),e.jsx(hn,{}),e.jsx(Mn,{}),e.jsx(Ee,{isOpen:l,onClose:()=>u(!1)}),e.jsx(Tn,{isOpen:o,onClose:()=>h(!1)}),e.jsx(Wn,{isOpen:c,onClose:()=>g(!1),onReadAgain:()=>{g(!1),k(0,0)},onImportNew:()=>{g(!1),u(!0)}}),y.checked&&y.showOnboarding&&e.jsx(Rn,{onComplete:y.close})]})}class Bn extends b.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r)}handleReload=()=>{window.location.reload()};handleReset=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h1",{className:"text-xl font-semibold mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm opacity-70 mb-6",children:"An unexpected error occurred. Please try reloading the page."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Reload Page"}),e.jsx("button",{onClick:this.handleReset,className:"px-4 py-2 border border-current/20 rounded-lg hover:bg-current/5 transition-colors",children:"Try Again"})]}),!1]})}):this.props.children}}Ue.createRoot(document.getElementById("root")).render(e.jsx(H.StrictMode,{children:e.jsx(Bn,{children:e.jsx(gn,{children:e.jsx(_n,{})})})}));
